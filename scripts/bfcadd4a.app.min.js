"use strict";angular.module("PalSzak.Hexwar",["ngAnimate","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","ui.slider"]).config(["$locationProvider","$routeProvider",function(a,b){a.html5Mode(!1),b.when("/",{templateUrl:"views/home.html"}).when("/game",{templateUrl:"views/game.html"}).otherwise({redirectTo:"/"})}]),angular.module("PalSzak.Hexwar").constant("version","v0.1.0").constant("sizes",[{name:"hex_size_xs",size:20},{name:"hex_size_sm",size:25},{name:"hex_size_md",size:35},{name:"hex_size_lg",size:50}]).constant("neighbourName",hexWarCore.neighbourName).constant("neighbours",hexWarCore.neighbours),angular.module("PalSzak.Hexwar").constant("maps",[{name:"map3",maxPlayerLabel:"3 players map",maxPlayer:3},{name:"map4",maxPlayerLabel:"4 players map",maxPlayer:4},{name:"map2small",maxPlayerLabel:"2 players map",maxPlayer:2},{name:"map2",maxPlayerLabel:"2 players map",maxPlayer:2}]),angular.module("PalSzak.Hexwar").constant("map2",{0:{0:{population:2,owner:"empty"},1:{population:2,owner:"empty"},2:{population:2,owner:"empty"},3:{population:10,owner:"player1"},4:{population:2,owner:"empty"},5:{population:2,owner:"empty"},6:{population:2,owner:"empty"}},1:{0:{population:2,owner:"empty"},1:{population:2,owner:"natural"},2:{population:2,owner:"natural"},3:{population:2,owner:"natural"},4:{population:2,owner:"natural"},5:{population:2,owner:"natural"},6:{population:2,owner:"empty"}},2:{0:{population:2,owner:"natural"},1:{population:2,owner:"natural"},2:{population:2,owner:"natural"},3:{population:2,owner:"empty"},4:{population:2,owner:"natural"},5:{population:2,owner:"natural"},6:{population:2,owner:"natural"}},3:{0:{population:2,owner:"natural"},1:{population:2,owner:"natural"},2:{population:2,owner:"empty"},3:{population:2,owner:"empty"},4:{population:2,owner:"empty"},5:{population:2,owner:"natural"},6:{population:2,owner:"natural"}},4:{0:{population:2,owner:"natural"},1:{population:2,owner:"natural"},2:{population:2,owner:"empty"},3:{population:2,owner:"empty"},4:{population:2,owner:"empty"},5:{population:2,owner:"natural"},6:{population:2,owner:"natural"}},5:{0:{population:2,owner:"natural"},1:{population:2,owner:"natural"},2:{population:2,owner:"natural"},3:{population:2,owner:"natural"},4:{population:2,owner:"natural"},5:{population:2,owner:"natural"},6:{population:2,owner:"natural"}},6:{0:{population:2,owner:"empty"},1:{population:2,owner:"empty"},2:{population:2,owner:"natural"},3:{population:10,owner:"player2"},4:{population:2,owner:"natural"},5:{population:2,owner:"empty"},6:{population:2,owner:"empty"}}}),angular.module("PalSzak.Hexwar").constant("map2small",{0:{0:{population:10,owner:"player1"},1:{population:2,owner:"natural"},2:{population:2,owner:"player2"}}}),angular.module("PalSzak.Hexwar").constant("map3",{0:{0:{population:10,owner:"empty"},1:{population:2,owner:"natural"},2:{population:10,owner:"empty"},3:{population:10,owner:"empty"},4:{population:10,owner:"empty"},5:{population:10,owner:"empty"},6:{population:10,owner:"empty"},7:{population:10,owner:"empty"},8:{population:10,owner:"empty"},9:{population:2,owner:"natural"},10:{population:10,owner:"empty"}},1:{0:{population:2,owner:"natural"},1:{population:10,owner:"player1"},2:{population:2,owner:"natural"},3:{population:10,owner:"empty"},4:{population:10,owner:"empty"},5:{population:10,owner:"empty"},6:{population:10,owner:"empty"},7:{population:10,owner:"empty"},8:{population:2,owner:"natural"},9:{population:10,owner:"player2"},10:{population:2,owner:"natural"}},2:{0:{population:2,owner:"natural"},1:{population:2,owner:"natural"},2:{population:2,owner:"natural"},3:{population:2,owner:"natural"},4:{population:10,owner:"empty"},5:{population:2,owner:"natural"},6:{population:10,owner:"empty"},7:{population:2,owner:"natural"},8:{population:2,owner:"natural"},9:{population:2,owner:"natural"},10:{population:2,owner:"natural"}},3:{0:{population:10,owner:"empty"},1:{population:10,owner:"empty"},2:{population:10,owner:"empty"},3:{population:10,owner:"empty"},4:{population:2,owner:"natural"},5:{population:2,owner:"natural"},6:{population:2,owner:"natural"},7:{population:10,owner:"empty"},8:{population:10,owner:"empty"},9:{population:10,owner:"empty"},10:{population:10,owner:"empty"}},4:{0:{population:10,owner:"empty"},1:{population:10,owner:"empty"},2:{population:10,owner:"empty"},3:{population:10,owner:"empty"},4:{population:2,owner:"natural"},5:{population:2,owner:"natural"},6:{population:2,owner:"natural"},7:{population:10,owner:"empty"},8:{population:10,owner:"empty"},9:{population:10,owner:"empty"},10:{population:10,owner:"empty"}},5:{0:{population:10,owner:"empty"},1:{population:10,owner:"empty"},2:{population:10,owner:"empty"},3:{population:10,owner:"empty"},4:{population:10,owner:"empty"},5:{population:2,owner:"natural"},6:{population:10,owner:"empty"},7:{population:10,owner:"empty"},8:{population:10,owner:"empty"},9:{population:10,owner:"empty"},10:{population:10,owner:"empty"}},6:{0:{population:10,owner:"empty"},1:{population:10,owner:"empty"},2:{population:10,owner:"empty"},3:{population:10,owner:"empty"},4:{population:10,owner:"empty"},5:{population:2,owner:"natural"},6:{population:10,owner:"empty"},7:{population:10,owner:"empty"},8:{population:10,owner:"empty"},9:{population:10,owner:"empty"},10:{population:10,owner:"empty"}},7:{0:{population:10,owner:"empty"},1:{population:10,owner:"empty"},2:{population:10,owner:"empty"},3:{population:10,owner:"empty"},4:{population:2,owner:"natural"},5:{population:10,owner:"player3"},6:{population:2,owner:"natural"},7:{population:10,owner:"empty"},8:{population:10,owner:"empty"},9:{population:10,owner:"empty"},10:{population:10,owner:"empty"}},8:{0:{population:10,owner:"empty"},1:{population:10,owner:"empty"},2:{population:10,owner:"empty"},3:{population:10,owner:"empty"},4:{population:2,owner:"natural"},5:{population:2,owner:"natural"},6:{population:2,owner:"natural"},7:{population:10,owner:"empty"},8:{population:10,owner:"empty"},9:{population:10,owner:"empty"},10:{population:10,owner:"empty"}}}),angular.module("PalSzak.Hexwar").constant("map4",{0:{0:{population:10,owner:"player1"},1:{population:10,owner:"player1"},2:{population:10,owner:"natural"},3:{population:10,owner:"natural"},4:{population:10,owner:"natural"},5:{population:10,owner:"player2"},6:{population:10,owner:"player2"}},1:{0:{population:10,owner:"player1"},1:{population:10,owner:"player1"},2:{population:10,owner:"empty"},3:{population:10,owner:"empty"},4:{population:10,owner:"empty"},5:{population:10,owner:"player2"},6:{population:10,owner:"player2"}},2:{0:{population:10,owner:"natural"},1:{population:10,owner:"natural"},2:{population:10,owner:"natural"},3:{population:10,owner:"natural"},4:{population:10,owner:"natural"},5:{population:10,owner:"natural"},6:{population:10,owner:"natural"}},3:{0:{population:10,owner:"natural"},1:{population:10,owner:"natural"},2:{population:10,owner:"natural"},3:{population:10,owner:"empty"},4:{population:10,owner:"natural"},5:{population:10,owner:"natural"},6:{population:10,owner:"natural"}},4:{0:{population:10,owner:"natural"},1:{population:10,owner:"natural"},2:{population:10,owner:"natural"},3:{population:10,owner:"empty"},4:{population:10,owner:"natural"},5:{population:10,owner:"natural"},6:{population:10,owner:"natural"}},5:{0:{population:10,owner:"natural"},1:{population:10,owner:"natural"},2:{population:10,owner:"natural"},3:{population:10,owner:"natural"},4:{population:10,owner:"natural"},5:{population:10,owner:"natural"},6:{population:10,owner:"natural"}},6:{0:{population:10,owner:"natural"},1:{population:10,owner:"player4"},2:{population:10,owner:"natural"},3:{population:10,owner:"empty"},4:{population:10,owner:"natural"},5:{population:10,owner:"player3"},6:{population:10,owner:"natural"}},7:{0:{population:10,owner:"player4"},1:{population:10,owner:"player4"},2:{population:10,owner:"empty"},3:{population:10,owner:"natural"},4:{population:10,owner:"empty"},5:{population:10,owner:"player3"},6:{population:10,owner:"player3"}},8:{0:{population:10,owner:"player4"},1:{population:10,owner:"empty"},2:{population:10,owner:"natural"},3:{population:10,owner:"empty"},4:{population:10,owner:"natural"},5:{population:10,owner:"empty"},6:{population:10,owner:"player3"}}}),angular.module("PalSzak.Hexwar").controller("MenuController",["$scope","$location","$modal","gameService","selectService",function(a,b,c,d,e){function f(a){c.open({templateUrl:"views/partials/modal/end.html",controller:["$scope","$modalInstance","winner",function(a,b,c){a.winner=c,a.ok=function(){b.close("newGame")},a.cancel=function(){b.dismiss("cancel")}}],size:"lg",resolve:{winner:function(){return a}}})}a.isPlayer=!1,a.$watch(d.getActualPlayer,function(b){angular.isDefined(b)&&(a.isPlayer="player"===b.type,a.playerName=b.name)}),a.$on("$locationChangeSuccess",function(){a.inGame="/game"===b.path()?!0:!1}),a.turn=function(){var a=d.gameState();e.deselectAll(),d.nextTurn(),a!==d.gameState()&&f(d.getActualPlayer())},a.interruptGame=function(){"/game"===b.path()&&c.open({templateUrl:"views/partials/modal/interrupt.html",controller:["$scope","$modalInstance",function(a,b){a.ok=function(){b.close("close")},a.cancel=function(){b.dismiss("cancel")}}],size:"sm"})},a.openRules=function(){c.open({templateUrl:"views/partials/modal/rules.html",controller:["$scope","$modalInstance",function(a,b){a.ok=function(){b.close("close")}}],size:"lg"})},a.openAbout=function(){c.open({templateUrl:"views/partials/modal/about.html",controller:["$scope","$modalInstance",function(a,b){a.ok=function(){b.close("close")}}],size:"lg"})}}]),angular.module("PalSzak.Hexwar").controller("MoveController",["$scope","gameService","selectService",function(a,b,c){a.$on("selection-changed",function(){a.from=c.getSource(),a.to=c.getTarget(),angular.isDefined(a.from)&&angular.isDefined(a.to)?(a.max=a.from.population,a.percentMax=a.from.percentMax,angular.isDefined(a.from[c.getNameOfNeighbour()])?(a.moveCount=a.from[c.getNameOfNeighbour()],a.max+=a.moveCount):a.moveCount=angular.isDefined(a.from)?a.from.population:void 0,angular.isDefined(a.from[c.getNameOfNeighbour()+"_permanent"])?(a.movePercent=a.from[c.getNameOfNeighbour()+"_permanent"],a.percentMax+=a.movePercent):a.movePercent=void 0):(a.moveCount=void 0,a.movePercent=void 0),a.usable=angular.isDefined(a.from)&&angular.isDefined(a.to)}),a.move=function(){b.reciveAction({from:a.from,to:a.to,moveCount:a.moveCount,permanentMove:a.movePercent,directionName:c.getNameOfNeighbour()}),c.deselectAll()}}]),angular.module("PalSzak.Hexwar").controller("NewGameController",["$scope","$location","maps","gameService",function(a,b,c,d){a.maps=c,a.gameModel={},a.gameModel.map=c[0],a.newGame=function(){d.startGame(a.gameModel),b.path("/game")}}]),angular.module("PalSzak.Hexwar").directive("hex",function(){return{restrict:"A",replace:"true",scope:{hex:"=",even:"="},templateUrl:"views/partials/game/hex.html",link:function(){},controller:["$scope","gameService","selectService",function(a,b,c){a.even=a.even?"even":"",a.field=b.getBoardField(a.hex),"empty"!==a.field.owner&&(a.select=c.setClicked,a.$on("selection-changed",function(){a.marker=angular.equals(a.field,c.getTarget())?"neighbour":angular.equals(a.field,c.getSource())?"active":angular.isUndefined(c.getTarget())&&angular.isDefined(c.getSource())&&c.getSource().getNameOfNeighbour(a.field)?"neighbour":""}))}]}}),angular.module("PalSzak.Hexwar").directive("hexfield",["$location","gameService",function(){return{scope:!0,templateUrl:"views/partials/game/hexField.html",controller:["$scope","$rootScope","$location","$timeout","sizes","gameService","selectService",function(a,b,c,d,e,f,g){function h(a){return 2*a+2.1*(f.getBoardColumnCount()-1)*a*3/4+"px"}if(angular.isUndefined(f.gameState()))return void c.path("/");var i=2;a.size=e[i].name,a.select=g.setClicked,a.getColumnCount=f.getBoardColumnCount,a.getRowCount=f.getBoardRowCount,a.getNumber=function(a){return Array.apply(null,{length:a}).map(Number.call,Number)},b.$on("actions-recived",function(b,c){a.$apply(function(){c.forEach(function(a){a.from=f.getBoardField(a.from.coord),a.to=f.getBoardField(a.to.coord),f.reciveAction(a)}),d(function(){f.nextTurn()},1500)})}),a.width={width:h(e[i].size)},a.zoomIn=function(){i+=i+1<e.length?1:0,a.size=e[i].name,a.width={width:h(e[i].size)}},a.zoomOut=function(){i-=i-1>-1?1:0,a.size=e[i].name,a.width={width:h(e[i].size)}}}]}}]),angular.module("PalSzak.Hexwar").service("selectService",["$rootScope","gameService",function(a,b){var c,d,e;this.getNameOfNeighbour=function(){return e},this.getSource=function(){return c},this.getTarget=function(){return d},this.setClicked=function(f){var g=!1;e=angular.isDefined(c)?c.getNameOfNeighbour(f):void 0,angular.equals(f,c)?(c=void 0,d=void 0,g=!0):angular.isDefined(c)&&e?(d=f,g=!0):"player"===b.getActualPlayer().type&&f.owner===b.getActualPlayer().id&&(c=f,d=void 0,g=!0),g&&a.$broadcast("selection-changed")},this.deselectAll=function(){this.setClicked(c)}}]),angular.module("PalSzak.Hexwar").service("gameService",["$rootScope","$injector","ai",function(a,b,c){var d;this.startGame=function(a){d=new hexWarCore.Game(angular.copy(b.get(a.map.name)),a)},this.getActualPlayer=function(){return angular.isUndefined(d)?void 0:d.getActualPlayer()},this.nextTurn=function(){d.nextTurn(),d.isAITurn()&&c.work({game:d})},this.gameState=function(){return angular.isUndefined(d)?void 0:d.isFinished()},this.getBoardField=function(a){return d.getBoardField(a)},this.getBoardRowCount=function(){return d.getBoardRowCount()},this.getBoardColumnCount=function(){return d.getBoardColumnCount()},this.reciveAction=function(a){return d.reciveAction(a)}}]),angular.module("PalSzak.Hexwar").service("ai",["$rootScope",function(a){function b(b){console.log(b),a.$emit("actions-recived",b.data)}function c(a){throw console.log(a),a.data}var d=new Worker("/scripts/workers/91f213f0.ai.js");this.work=function(a){d.onmessage=function(a){switch(a.data.type){case"debug":console.log.apply(console,a.data.message);break;default:b(a)}},d.onerror=c,console.log("WORKER START"),d.postMessage(a)}}]);